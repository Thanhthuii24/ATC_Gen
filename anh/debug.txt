# !python inference_ATC.py
!python /content/drive/MyDrive/ATC_/text_to_image/inference_ATC.py
Kết quả truyền trực tuyến bị cắt bớt đến 5000 dòng cuối.
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] after bottleneck: torch.Size([1, 512, 64])
[DEBUG] after cross_attn: torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 1024, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 64, 512])
[DEBUG] Forward end output shape=torch.Size([1, 1, 512])
[DEBUG] Forward start: x=torch.Size([1, 1, 512]), cond=torch.Size([1, 8]), t=tensor([720], device='cuda:0')
[DEBUG] cond input shape=torch.Size([1, 8]), t=tensor([720], device='cuda:0')
[DEBUG] timestep_embedding: output shape=torch.Size([1, 128])
[DEBUG] combined embedding shape=torch.Size([1, 128])
[DEBUG] after input_conv: torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] MultiScaleAttention output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] after bottleneck: torch.Size([1, 512, 64])
[DEBUG] after cross_attn: torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 1024, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 64, 512])
[DEBUG] Forward end output shape=torch.Size([1, 1, 512])
[DEBUG] Forward start: x=torch.Size([1, 1, 512]), cond=torch.Size([1, 8]), t=tensor([710], device='cuda:0')
[DEBUG] cond input shape=torch.Size([1, 8]), t=tensor([710], device='cuda:0')
[DEBUG] timestep_embedding: output shape=torch.Size([1, 128])
[DEBUG] combined embedding shape=torch.Size([1, 128])
[DEBUG] after input_conv: torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] MultiScaleAttention output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] after bottleneck: torch.Size([1, 512, 64])
[DEBUG] after cross_attn: torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 1024, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 64, 512])
[DEBUG] Forward end output shape=torch.Size([1, 1, 512])
[DEBUG] Forward start: x=torch.Size([1, 1, 512]), cond=torch.Size([1, 8]), t=tensor([700], device='cuda:0')
[DEBUG] cond input shape=torch.Size([1, 8]), t=tensor([700], device='cuda:0')
[DEBUG] timestep_embedding: output shape=torch.Size([1, 128])
[DEBUG] combined embedding shape=torch.Size([1, 128])
[DEBUG] after input_conv: torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] MultiScaleAttention output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] after bottleneck: torch.Size([1, 512, 64])
[DEBUG] after cross_attn: torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 1024, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 64, 512])
[DEBUG] Forward end output shape=torch.Size([1, 1, 512])
[DEBUG] Forward start: x=torch.Size([1, 1, 512]), cond=torch.Size([1, 8]), t=tensor([690], device='cuda:0')
[DEBUG] cond input shape=torch.Size([1, 8]), t=tensor([690], device='cuda:0')
[DEBUG] timestep_embedding: output shape=torch.Size([1, 128])
[DEBUG] combined embedding shape=torch.Size([1, 128])
[DEBUG] after input_conv: torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] MultiScaleAttention output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] after bottleneck: torch.Size([1, 512, 64])
[DEBUG] after cross_attn: torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 1024, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 64, 512])
[DEBUG] Forward end output shape=torch.Size([1, 1, 512])
[DEBUG] Forward start: x=torch.Size([1, 1, 512]), cond=torch.Size([1, 8]), t=tensor([680], device='cuda:0')
[DEBUG] cond input shape=torch.Size([1, 8]), t=tensor([680], device='cuda:0')
[DEBUG] timestep_embedding: output shape=torch.Size([1, 128])
[DEBUG] combined embedding shape=torch.Size([1, 128])
[DEBUG] after input_conv: torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] MultiScaleAttention output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] after bottleneck: torch.Size([1, 512, 64])
[DEBUG] after cross_attn: torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 1024, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 64, 512])
[DEBUG] Forward end output shape=torch.Size([1, 1, 512])
[DEBUG] Forward start: x=torch.Size([1, 1, 512]), cond=torch.Size([1, 8]), t=tensor([670], device='cuda:0')
[DEBUG] cond input shape=torch.Size([1, 8]), t=tensor([670], device='cuda:0')
[DEBUG] timestep_embedding: output shape=torch.Size([1, 128])
[DEBUG] combined embedding shape=torch.Size([1, 128])
[DEBUG] after input_conv: torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] MultiScaleAttention output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] after bottleneck: torch.Size([1, 512, 64])
[DEBUG] after cross_attn: torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 1024, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 64, 512])
[DEBUG] Forward end output shape=torch.Size([1, 1, 512])
[DEBUG] Forward start: x=torch.Size([1, 1, 512]), cond=torch.Size([1, 8]), t=tensor([660], device='cuda:0')
[DEBUG] cond input shape=torch.Size([1, 8]), t=tensor([660], device='cuda:0')
[DEBUG] timestep_embedding: output shape=torch.Size([1, 128])
[DEBUG] combined embedding shape=torch.Size([1, 128])
[DEBUG] after input_conv: torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] MultiScaleAttention output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] after bottleneck: torch.Size([1, 512, 64])
[DEBUG] after cross_attn: torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 1024, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 64, 512])
[DEBUG] Forward end output shape=torch.Size([1, 1, 512])
[DEBUG] Forward start: x=torch.Size([1, 1, 512]), cond=torch.Size([1, 8]), t=tensor([650], device='cuda:0')
[DEBUG] cond input shape=torch.Size([1, 8]), t=tensor([650], device='cuda:0')
[DEBUG] timestep_embedding: output shape=torch.Size([1, 128])
[DEBUG] combined embedding shape=torch.Size([1, 128])
[DEBUG] after input_conv: torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] MultiScaleAttention output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] after bottleneck: torch.Size([1, 512, 64])
[DEBUG] after cross_attn: torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 1024, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 64, 512])
[DEBUG] Forward end output shape=torch.Size([1, 1, 512])
[DEBUG] Forward start: x=torch.Size([1, 1, 512]), cond=torch.Size([1, 8]), t=tensor([640], device='cuda:0')
[DEBUG] cond input shape=torch.Size([1, 8]), t=tensor([640], device='cuda:0')
[DEBUG] timestep_embedding: output shape=torch.Size([1, 128])
[DEBUG] combined embedding shape=torch.Size([1, 128])
[DEBUG] after input_conv: torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] MultiScaleAttention output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] after bottleneck: torch.Size([1, 512, 64])
[DEBUG] after cross_attn: torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 1024, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 64, 512])
[DEBUG] Forward end output shape=torch.Size([1, 1, 512])
[DEBUG] Forward start: x=torch.Size([1, 1, 512]), cond=torch.Size([1, 8]), t=tensor([630], device='cuda:0')
[DEBUG] cond input shape=torch.Size([1, 8]), t=tensor([630], device='cuda:0')
[DEBUG] timestep_embedding: output shape=torch.Size([1, 128])
[DEBUG] combined embedding shape=torch.Size([1, 128])
[DEBUG] after input_conv: torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] MultiScaleAttention output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] after bottleneck: torch.Size([1, 512, 64])
[DEBUG] after cross_attn: torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 1024, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 64, 512])
[DEBUG] Forward end output shape=torch.Size([1, 1, 512])
[DEBUG] Forward start: x=torch.Size([1, 1, 512]), cond=torch.Size([1, 8]), t=tensor([620], device='cuda:0')
[DEBUG] cond input shape=torch.Size([1, 8]), t=tensor([620], device='cuda:0')
[DEBUG] timestep_embedding: output shape=torch.Size([1, 128])
[DEBUG] combined embedding shape=torch.Size([1, 128])
[DEBUG] after input_conv: torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] MultiScaleAttention output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] after bottleneck: torch.Size([1, 512, 64])
[DEBUG] after cross_attn: torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 1024, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 64, 512])
[DEBUG] Forward end output shape=torch.Size([1, 1, 512])
[DEBUG] Forward start: x=torch.Size([1, 1, 512]), cond=torch.Size([1, 8]), t=tensor([610], device='cuda:0')
[DEBUG] cond input shape=torch.Size([1, 8]), t=tensor([610], device='cuda:0')
[DEBUG] timestep_embedding: output shape=torch.Size([1, 128])
[DEBUG] combined embedding shape=torch.Size([1, 128])
[DEBUG] after input_conv: torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] MultiScaleAttention output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] after bottleneck: torch.Size([1, 512, 64])
[DEBUG] after cross_attn: torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 1024, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 64, 512])
[DEBUG] Forward end output shape=torch.Size([1, 1, 512])
[DEBUG] Forward start: x=torch.Size([1, 1, 512]), cond=torch.Size([1, 8]), t=tensor([600], device='cuda:0')
[DEBUG] cond input shape=torch.Size([1, 8]), t=tensor([600], device='cuda:0')
[DEBUG] timestep_embedding: output shape=torch.Size([1, 128])
[DEBUG] combined embedding shape=torch.Size([1, 128])
[DEBUG] after input_conv: torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] MultiScaleAttention output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] after bottleneck: torch.Size([1, 512, 64])
[DEBUG] after cross_attn: torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 1024, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 64, 512])
[DEBUG] Forward end output shape=torch.Size([1, 1, 512])
[DEBUG] Forward start: x=torch.Size([1, 1, 512]), cond=torch.Size([1, 8]), t=tensor([590], device='cuda:0')
[DEBUG] cond input shape=torch.Size([1, 8]), t=tensor([590], device='cuda:0')
[DEBUG] timestep_embedding: output shape=torch.Size([1, 128])
[DEBUG] combined embedding shape=torch.Size([1, 128])
[DEBUG] after input_conv: torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] MultiScaleAttention output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] after bottleneck: torch.Size([1, 512, 64])
[DEBUG] after cross_attn: torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 1024, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 64, 512])
[DEBUG] Forward end output shape=torch.Size([1, 1, 512])
[DEBUG] Step 41/100, t=590
[DEBUG] Forward start: x=torch.Size([1, 1, 512]), cond=torch.Size([1, 8]), t=tensor([580], device='cuda:0')
[DEBUG] cond input shape=torch.Size([1, 8]), t=tensor([580], device='cuda:0')
[DEBUG] timestep_embedding: output shape=torch.Size([1, 128])
[DEBUG] combined embedding shape=torch.Size([1, 128])
[DEBUG] after input_conv: torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] MultiScaleAttention output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] after bottleneck: torch.Size([1, 512, 64])
[DEBUG] after cross_attn: torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 1024, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 64, 512])
[DEBUG] Forward end output shape=torch.Size([1, 1, 512])
[DEBUG] Forward start: x=torch.Size([1, 1, 512]), cond=torch.Size([1, 8]), t=tensor([570], device='cuda:0')
[DEBUG] cond input shape=torch.Size([1, 8]), t=tensor([570], device='cuda:0')
[DEBUG] timestep_embedding: output shape=torch.Size([1, 128])
[DEBUG] combined embedding shape=torch.Size([1, 128])
[DEBUG] after input_conv: torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] MultiScaleAttention output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] after bottleneck: torch.Size([1, 512, 64])
[DEBUG] after cross_attn: torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 1024, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 64, 512])
[DEBUG] Forward end output shape=torch.Size([1, 1, 512])
[DEBUG] Forward start: x=torch.Size([1, 1, 512]), cond=torch.Size([1, 8]), t=tensor([560], device='cuda:0')
[DEBUG] cond input shape=torch.Size([1, 8]), t=tensor([560], device='cuda:0')
[DEBUG] timestep_embedding: output shape=torch.Size([1, 128])
[DEBUG] combined embedding shape=torch.Size([1, 128])
[DEBUG] after input_conv: torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] MultiScaleAttention output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] after bottleneck: torch.Size([1, 512, 64])
[DEBUG] after cross_attn: torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 1024, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 64, 512])
[DEBUG] Forward end output shape=torch.Size([1, 1, 512])
[DEBUG] Forward start: x=torch.Size([1, 1, 512]), cond=torch.Size([1, 8]), t=tensor([550], device='cuda:0')
[DEBUG] cond input shape=torch.Size([1, 8]), t=tensor([550], device='cuda:0')
[DEBUG] timestep_embedding: output shape=torch.Size([1, 128])
[DEBUG] combined embedding shape=torch.Size([1, 128])
[DEBUG] after input_conv: torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] MultiScaleAttention output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] after bottleneck: torch.Size([1, 512, 64])
[DEBUG] after cross_attn: torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 1024, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 64, 512])
[DEBUG] Forward end output shape=torch.Size([1, 1, 512])
[DEBUG] Forward start: x=torch.Size([1, 1, 512]), cond=torch.Size([1, 8]), t=tensor([540], device='cuda:0')
[DEBUG] cond input shape=torch.Size([1, 8]), t=tensor([540], device='cuda:0')
[DEBUG] timestep_embedding: output shape=torch.Size([1, 128])
[DEBUG] combined embedding shape=torch.Size([1, 128])
[DEBUG] after input_conv: torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] MultiScaleAttention output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] after bottleneck: torch.Size([1, 512, 64])
[DEBUG] after cross_attn: torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 1024, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 64, 512])
[DEBUG] Forward end output shape=torch.Size([1, 1, 512])
[DEBUG] Forward start: x=torch.Size([1, 1, 512]), cond=torch.Size([1, 8]), t=tensor([530], device='cuda:0')
[DEBUG] cond input shape=torch.Size([1, 8]), t=tensor([530], device='cuda:0')
[DEBUG] timestep_embedding: output shape=torch.Size([1, 128])
[DEBUG] combined embedding shape=torch.Size([1, 128])
[DEBUG] after input_conv: torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] MultiScaleAttention output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] after bottleneck: torch.Size([1, 512, 64])
[DEBUG] after cross_attn: torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 1024, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 64, 512])
[DEBUG] Forward end output shape=torch.Size([1, 1, 512])
[DEBUG] Forward start: x=torch.Size([1, 1, 512]), cond=torch.Size([1, 8]), t=tensor([520], device='cuda:0')
[DEBUG] cond input shape=torch.Size([1, 8]), t=tensor([520], device='cuda:0')
[DEBUG] timestep_embedding: output shape=torch.Size([1, 128])
[DEBUG] combined embedding shape=torch.Size([1, 128])
[DEBUG] after input_conv: torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] MultiScaleAttention output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] after bottleneck: torch.Size([1, 512, 64])
[DEBUG] after cross_attn: torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 1024, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 64, 512])
[DEBUG] Forward end output shape=torch.Size([1, 1, 512])
[DEBUG] Forward start: x=torch.Size([1, 1, 512]), cond=torch.Size([1, 8]), t=tensor([510], device='cuda:0')
[DEBUG] cond input shape=torch.Size([1, 8]), t=tensor([510], device='cuda:0')
[DEBUG] timestep_embedding: output shape=torch.Size([1, 128])
[DEBUG] combined embedding shape=torch.Size([1, 128])
[DEBUG] after input_conv: torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] MultiScaleAttention output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] after bottleneck: torch.Size([1, 512, 64])
[DEBUG] after cross_attn: torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 1024, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 64, 512])
[DEBUG] Forward end output shape=torch.Size([1, 1, 512])
[DEBUG] Forward start: x=torch.Size([1, 1, 512]), cond=torch.Size([1, 8]), t=tensor([500], device='cuda:0')
[DEBUG] cond input shape=torch.Size([1, 8]), t=tensor([500], device='cuda:0')
[DEBUG] timestep_embedding: output shape=torch.Size([1, 128])
[DEBUG] combined embedding shape=torch.Size([1, 128])
[DEBUG] after input_conv: torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] MultiScaleAttention output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] after bottleneck: torch.Size([1, 512, 64])
[DEBUG] after cross_attn: torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 1024, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 64, 512])
[DEBUG] Forward end output shape=torch.Size([1, 1, 512])
[DEBUG] Forward start: x=torch.Size([1, 1, 512]), cond=torch.Size([1, 8]), t=tensor([490], device='cuda:0')
[DEBUG] cond input shape=torch.Size([1, 8]), t=tensor([490], device='cuda:0')
[DEBUG] timestep_embedding: output shape=torch.Size([1, 128])
[DEBUG] combined embedding shape=torch.Size([1, 128])
[DEBUG] after input_conv: torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] MultiScaleAttention output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] after bottleneck: torch.Size([1, 512, 64])
[DEBUG] after cross_attn: torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 1024, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 64, 512])
[DEBUG] Forward end output shape=torch.Size([1, 1, 512])
[DEBUG] Forward start: x=torch.Size([1, 1, 512]), cond=torch.Size([1, 8]), t=tensor([480], device='cuda:0')
[DEBUG] cond input shape=torch.Size([1, 8]), t=tensor([480], device='cuda:0')
[DEBUG] timestep_embedding: output shape=torch.Size([1, 128])
[DEBUG] combined embedding shape=torch.Size([1, 128])
[DEBUG] after input_conv: torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] MultiScaleAttention output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] after bottleneck: torch.Size([1, 512, 64])
[DEBUG] after cross_attn: torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 1024, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 64, 512])
[DEBUG] Forward end output shape=torch.Size([1, 1, 512])
[DEBUG] Forward start: x=torch.Size([1, 1, 512]), cond=torch.Size([1, 8]), t=tensor([470], device='cuda:0')
[DEBUG] cond input shape=torch.Size([1, 8]), t=tensor([470], device='cuda:0')
[DEBUG] timestep_embedding: output shape=torch.Size([1, 128])
[DEBUG] combined embedding shape=torch.Size([1, 128])
[DEBUG] after input_conv: torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] MultiScaleAttention output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] after bottleneck: torch.Size([1, 512, 64])
[DEBUG] after cross_attn: torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 1024, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 64, 512])
[DEBUG] Forward end output shape=torch.Size([1, 1, 512])
[DEBUG] Forward start: x=torch.Size([1, 1, 512]), cond=torch.Size([1, 8]), t=tensor([460], device='cuda:0')
[DEBUG] cond input shape=torch.Size([1, 8]), t=tensor([460], device='cuda:0')
[DEBUG] timestep_embedding: output shape=torch.Size([1, 128])
[DEBUG] combined embedding shape=torch.Size([1, 128])
[DEBUG] after input_conv: torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] MultiScaleAttention output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] after bottleneck: torch.Size([1, 512, 64])
[DEBUG] after cross_attn: torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 1024, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 64, 512])
[DEBUG] Forward end output shape=torch.Size([1, 1, 512])
[DEBUG] Forward start: x=torch.Size([1, 1, 512]), cond=torch.Size([1, 8]), t=tensor([450], device='cuda:0')
[DEBUG] cond input shape=torch.Size([1, 8]), t=tensor([450], device='cuda:0')
[DEBUG] timestep_embedding: output shape=torch.Size([1, 128])
[DEBUG] combined embedding shape=torch.Size([1, 128])
[DEBUG] after input_conv: torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] MultiScaleAttention output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] after bottleneck: torch.Size([1, 512, 64])
[DEBUG] after cross_attn: torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 1024, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 64, 512])
[DEBUG] Forward end output shape=torch.Size([1, 1, 512])
[DEBUG] Forward start: x=torch.Size([1, 1, 512]), cond=torch.Size([1, 8]), t=tensor([440], device='cuda:0')
[DEBUG] cond input shape=torch.Size([1, 8]), t=tensor([440], device='cuda:0')
[DEBUG] timestep_embedding: output shape=torch.Size([1, 128])
[DEBUG] combined embedding shape=torch.Size([1, 128])
[DEBUG] after input_conv: torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] MultiScaleAttention output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] after bottleneck: torch.Size([1, 512, 64])
[DEBUG] after cross_attn: torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 1024, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 64, 512])
[DEBUG] Forward end output shape=torch.Size([1, 1, 512])
[DEBUG] Forward start: x=torch.Size([1, 1, 512]), cond=torch.Size([1, 8]), t=tensor([430], device='cuda:0')
[DEBUG] cond input shape=torch.Size([1, 8]), t=tensor([430], device='cuda:0')
[DEBUG] timestep_embedding: output shape=torch.Size([1, 128])
[DEBUG] combined embedding shape=torch.Size([1, 128])
[DEBUG] after input_conv: torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] MultiScaleAttention output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] after bottleneck: torch.Size([1, 512, 64])
[DEBUG] after cross_attn: torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 1024, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 64, 512])
[DEBUG] Forward end output shape=torch.Size([1, 1, 512])
[DEBUG] Forward start: x=torch.Size([1, 1, 512]), cond=torch.Size([1, 8]), t=tensor([420], device='cuda:0')
[DEBUG] cond input shape=torch.Size([1, 8]), t=tensor([420], device='cuda:0')
[DEBUG] timestep_embedding: output shape=torch.Size([1, 128])
[DEBUG] combined embedding shape=torch.Size([1, 128])
[DEBUG] after input_conv: torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] MultiScaleAttention output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] after bottleneck: torch.Size([1, 512, 64])
[DEBUG] after cross_attn: torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 1024, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 64, 512])
[DEBUG] Forward end output shape=torch.Size([1, 1, 512])
[DEBUG] Forward start: x=torch.Size([1, 1, 512]), cond=torch.Size([1, 8]), t=tensor([410], device='cuda:0')
[DEBUG] cond input shape=torch.Size([1, 8]), t=tensor([410], device='cuda:0')
[DEBUG] timestep_embedding: output shape=torch.Size([1, 128])
[DEBUG] combined embedding shape=torch.Size([1, 128])
[DEBUG] after input_conv: torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] MultiScaleAttention output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] after bottleneck: torch.Size([1, 512, 64])
[DEBUG] after cross_attn: torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 1024, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 64, 512])
[DEBUG] Forward end output shape=torch.Size([1, 1, 512])
[DEBUG] Forward start: x=torch.Size([1, 1, 512]), cond=torch.Size([1, 8]), t=tensor([400], device='cuda:0')
[DEBUG] cond input shape=torch.Size([1, 8]), t=tensor([400], device='cuda:0')
[DEBUG] timestep_embedding: output shape=torch.Size([1, 128])
[DEBUG] combined embedding shape=torch.Size([1, 128])
[DEBUG] after input_conv: torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] MultiScaleAttention output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] after bottleneck: torch.Size([1, 512, 64])
[DEBUG] after cross_attn: torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 1024, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 64, 512])
[DEBUG] Forward end output shape=torch.Size([1, 1, 512])
[DEBUG] Forward start: x=torch.Size([1, 1, 512]), cond=torch.Size([1, 8]), t=tensor([390], device='cuda:0')
[DEBUG] cond input shape=torch.Size([1, 8]), t=tensor([390], device='cuda:0')
[DEBUG] timestep_embedding: output shape=torch.Size([1, 128])
[DEBUG] combined embedding shape=torch.Size([1, 128])
[DEBUG] after input_conv: torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] MultiScaleAttention output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] after bottleneck: torch.Size([1, 512, 64])
[DEBUG] after cross_attn: torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 1024, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 64, 512])
[DEBUG] Forward end output shape=torch.Size([1, 1, 512])
[DEBUG] Step 61/100, t=390
[DEBUG] Forward start: x=torch.Size([1, 1, 512]), cond=torch.Size([1, 8]), t=tensor([380], device='cuda:0')
[DEBUG] cond input shape=torch.Size([1, 8]), t=tensor([380], device='cuda:0')
[DEBUG] timestep_embedding: output shape=torch.Size([1, 128])
[DEBUG] combined embedding shape=torch.Size([1, 128])
[DEBUG] after input_conv: torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] MultiScaleAttention output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] after bottleneck: torch.Size([1, 512, 64])
[DEBUG] after cross_attn: torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 1024, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 64, 512])
[DEBUG] Forward end output shape=torch.Size([1, 1, 512])
[DEBUG] Forward start: x=torch.Size([1, 1, 512]), cond=torch.Size([1, 8]), t=tensor([370], device='cuda:0')
[DEBUG] cond input shape=torch.Size([1, 8]), t=tensor([370], device='cuda:0')
[DEBUG] timestep_embedding: output shape=torch.Size([1, 128])
[DEBUG] combined embedding shape=torch.Size([1, 128])
[DEBUG] after input_conv: torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] MultiScaleAttention output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] after bottleneck: torch.Size([1, 512, 64])
[DEBUG] after cross_attn: torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 1024, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 64, 512])
[DEBUG] Forward end output shape=torch.Size([1, 1, 512])
[DEBUG] Forward start: x=torch.Size([1, 1, 512]), cond=torch.Size([1, 8]), t=tensor([360], device='cuda:0')
[DEBUG] cond input shape=torch.Size([1, 8]), t=tensor([360], device='cuda:0')
[DEBUG] timestep_embedding: output shape=torch.Size([1, 128])
[DEBUG] combined embedding shape=torch.Size([1, 128])
[DEBUG] after input_conv: torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] MultiScaleAttention output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] after bottleneck: torch.Size([1, 512, 64])
[DEBUG] after cross_attn: torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 1024, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 64, 512])
[DEBUG] Forward end output shape=torch.Size([1, 1, 512])
[DEBUG] Forward start: x=torch.Size([1, 1, 512]), cond=torch.Size([1, 8]), t=tensor([350], device='cuda:0')
[DEBUG] cond input shape=torch.Size([1, 8]), t=tensor([350], device='cuda:0')
[DEBUG] timestep_embedding: output shape=torch.Size([1, 128])
[DEBUG] combined embedding shape=torch.Size([1, 128])
[DEBUG] after input_conv: torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] MultiScaleAttention output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] after bottleneck: torch.Size([1, 512, 64])
[DEBUG] after cross_attn: torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 1024, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 64, 512])
[DEBUG] Forward end output shape=torch.Size([1, 1, 512])
[DEBUG] Forward start: x=torch.Size([1, 1, 512]), cond=torch.Size([1, 8]), t=tensor([340], device='cuda:0')
[DEBUG] cond input shape=torch.Size([1, 8]), t=tensor([340], device='cuda:0')
[DEBUG] timestep_embedding: output shape=torch.Size([1, 128])
[DEBUG] combined embedding shape=torch.Size([1, 128])
[DEBUG] after input_conv: torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] MultiScaleAttention output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] after bottleneck: torch.Size([1, 512, 64])
[DEBUG] after cross_attn: torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 1024, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 64, 512])
[DEBUG] Forward end output shape=torch.Size([1, 1, 512])
[DEBUG] Forward start: x=torch.Size([1, 1, 512]), cond=torch.Size([1, 8]), t=tensor([330], device='cuda:0')
[DEBUG] cond input shape=torch.Size([1, 8]), t=tensor([330], device='cuda:0')
[DEBUG] timestep_embedding: output shape=torch.Size([1, 128])
[DEBUG] combined embedding shape=torch.Size([1, 128])
[DEBUG] after input_conv: torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] MultiScaleAttention output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] after bottleneck: torch.Size([1, 512, 64])
[DEBUG] after cross_attn: torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 1024, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 64, 512])
[DEBUG] Forward end output shape=torch.Size([1, 1, 512])
[DEBUG] Forward start: x=torch.Size([1, 1, 512]), cond=torch.Size([1, 8]), t=tensor([320], device='cuda:0')
[DEBUG] cond input shape=torch.Size([1, 8]), t=tensor([320], device='cuda:0')
[DEBUG] timestep_embedding: output shape=torch.Size([1, 128])
[DEBUG] combined embedding shape=torch.Size([1, 128])
[DEBUG] after input_conv: torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] MultiScaleAttention output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] after bottleneck: torch.Size([1, 512, 64])
[DEBUG] after cross_attn: torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 1024, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 64, 512])
[DEBUG] Forward end output shape=torch.Size([1, 1, 512])
[DEBUG] Forward start: x=torch.Size([1, 1, 512]), cond=torch.Size([1, 8]), t=tensor([310], device='cuda:0')
[DEBUG] cond input shape=torch.Size([1, 8]), t=tensor([310], device='cuda:0')
[DEBUG] timestep_embedding: output shape=torch.Size([1, 128])
[DEBUG] combined embedding shape=torch.Size([1, 128])
[DEBUG] after input_conv: torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] MultiScaleAttention output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] after bottleneck: torch.Size([1, 512, 64])
[DEBUG] after cross_attn: torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 1024, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 64, 512])
[DEBUG] Forward end output shape=torch.Size([1, 1, 512])
[DEBUG] Forward start: x=torch.Size([1, 1, 512]), cond=torch.Size([1, 8]), t=tensor([300], device='cuda:0')
[DEBUG] cond input shape=torch.Size([1, 8]), t=tensor([300], device='cuda:0')
[DEBUG] timestep_embedding: output shape=torch.Size([1, 128])
[DEBUG] combined embedding shape=torch.Size([1, 128])
[DEBUG] after input_conv: torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] MultiScaleAttention output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] after bottleneck: torch.Size([1, 512, 64])
[DEBUG] after cross_attn: torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 1024, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 64, 512])
[DEBUG] Forward end output shape=torch.Size([1, 1, 512])
[DEBUG] Forward start: x=torch.Size([1, 1, 512]), cond=torch.Size([1, 8]), t=tensor([290], device='cuda:0')
[DEBUG] cond input shape=torch.Size([1, 8]), t=tensor([290], device='cuda:0')
[DEBUG] timestep_embedding: output shape=torch.Size([1, 128])
[DEBUG] combined embedding shape=torch.Size([1, 128])
[DEBUG] after input_conv: torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] MultiScaleAttention output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] after bottleneck: torch.Size([1, 512, 64])
[DEBUG] after cross_attn: torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 1024, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 64, 512])
[DEBUG] Forward end output shape=torch.Size([1, 1, 512])
[DEBUG] Forward start: x=torch.Size([1, 1, 512]), cond=torch.Size([1, 8]), t=tensor([280], device='cuda:0')
[DEBUG] cond input shape=torch.Size([1, 8]), t=tensor([280], device='cuda:0')
[DEBUG] timestep_embedding: output shape=torch.Size([1, 128])
[DEBUG] combined embedding shape=torch.Size([1, 128])
[DEBUG] after input_conv: torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] MultiScaleAttention output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] after bottleneck: torch.Size([1, 512, 64])
[DEBUG] after cross_attn: torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 1024, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 64, 512])
[DEBUG] Forward end output shape=torch.Size([1, 1, 512])
[DEBUG] Forward start: x=torch.Size([1, 1, 512]), cond=torch.Size([1, 8]), t=tensor([270], device='cuda:0')
[DEBUG] cond input shape=torch.Size([1, 8]), t=tensor([270], device='cuda:0')
[DEBUG] timestep_embedding: output shape=torch.Size([1, 128])
[DEBUG] combined embedding shape=torch.Size([1, 128])
[DEBUG] after input_conv: torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] MultiScaleAttention output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] after bottleneck: torch.Size([1, 512, 64])
[DEBUG] after cross_attn: torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 1024, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 64, 512])
[DEBUG] Forward end output shape=torch.Size([1, 1, 512])
[DEBUG] Forward start: x=torch.Size([1, 1, 512]), cond=torch.Size([1, 8]), t=tensor([260], device='cuda:0')
[DEBUG] cond input shape=torch.Size([1, 8]), t=tensor([260], device='cuda:0')
[DEBUG] timestep_embedding: output shape=torch.Size([1, 128])
[DEBUG] combined embedding shape=torch.Size([1, 128])
[DEBUG] after input_conv: torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] MultiScaleAttention output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] after bottleneck: torch.Size([1, 512, 64])
[DEBUG] after cross_attn: torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 1024, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 64, 512])
[DEBUG] Forward end output shape=torch.Size([1, 1, 512])
[DEBUG] Forward start: x=torch.Size([1, 1, 512]), cond=torch.Size([1, 8]), t=tensor([250], device='cuda:0')
[DEBUG] cond input shape=torch.Size([1, 8]), t=tensor([250], device='cuda:0')
[DEBUG] timestep_embedding: output shape=torch.Size([1, 128])
[DEBUG] combined embedding shape=torch.Size([1, 128])
[DEBUG] after input_conv: torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] MultiScaleAttention output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] after bottleneck: torch.Size([1, 512, 64])
[DEBUG] after cross_attn: torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 1024, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 64, 512])
[DEBUG] Forward end output shape=torch.Size([1, 1, 512])
[DEBUG] Forward start: x=torch.Size([1, 1, 512]), cond=torch.Size([1, 8]), t=tensor([240], device='cuda:0')
[DEBUG] cond input shape=torch.Size([1, 8]), t=tensor([240], device='cuda:0')
[DEBUG] timestep_embedding: output shape=torch.Size([1, 128])
[DEBUG] combined embedding shape=torch.Size([1, 128])
[DEBUG] after input_conv: torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] MultiScaleAttention output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] after bottleneck: torch.Size([1, 512, 64])
[DEBUG] after cross_attn: torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 1024, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 64, 512])
[DEBUG] Forward end output shape=torch.Size([1, 1, 512])
[DEBUG] Forward start: x=torch.Size([1, 1, 512]), cond=torch.Size([1, 8]), t=tensor([230], device='cuda:0')
[DEBUG] cond input shape=torch.Size([1, 8]), t=tensor([230], device='cuda:0')
[DEBUG] timestep_embedding: output shape=torch.Size([1, 128])
[DEBUG] combined embedding shape=torch.Size([1, 128])
[DEBUG] after input_conv: torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] MultiScaleAttention output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] after bottleneck: torch.Size([1, 512, 64])
[DEBUG] after cross_attn: torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 1024, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 64, 512])
[DEBUG] Forward end output shape=torch.Size([1, 1, 512])
[DEBUG] Forward start: x=torch.Size([1, 1, 512]), cond=torch.Size([1, 8]), t=tensor([220], device='cuda:0')
[DEBUG] cond input shape=torch.Size([1, 8]), t=tensor([220], device='cuda:0')
[DEBUG] timestep_embedding: output shape=torch.Size([1, 128])
[DEBUG] combined embedding shape=torch.Size([1, 128])
[DEBUG] after input_conv: torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] MultiScaleAttention output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] after bottleneck: torch.Size([1, 512, 64])
[DEBUG] after cross_attn: torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 1024, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 64, 512])
[DEBUG] Forward end output shape=torch.Size([1, 1, 512])
[DEBUG] Forward start: x=torch.Size([1, 1, 512]), cond=torch.Size([1, 8]), t=tensor([210], device='cuda:0')
[DEBUG] cond input shape=torch.Size([1, 8]), t=tensor([210], device='cuda:0')
[DEBUG] timestep_embedding: output shape=torch.Size([1, 128])
[DEBUG] combined embedding shape=torch.Size([1, 128])
[DEBUG] after input_conv: torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] MultiScaleAttention output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] after bottleneck: torch.Size([1, 512, 64])
[DEBUG] after cross_attn: torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 1024, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 64, 512])
[DEBUG] Forward end output shape=torch.Size([1, 1, 512])
[DEBUG] Forward start: x=torch.Size([1, 1, 512]), cond=torch.Size([1, 8]), t=tensor([200], device='cuda:0')
[DEBUG] cond input shape=torch.Size([1, 8]), t=tensor([200], device='cuda:0')
[DEBUG] timestep_embedding: output shape=torch.Size([1, 128])
[DEBUG] combined embedding shape=torch.Size([1, 128])
[DEBUG] after input_conv: torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] MultiScaleAttention output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] after bottleneck: torch.Size([1, 512, 64])
[DEBUG] after cross_attn: torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 1024, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 64, 512])
[DEBUG] Forward end output shape=torch.Size([1, 1, 512])
[DEBUG] Forward start: x=torch.Size([1, 1, 512]), cond=torch.Size([1, 8]), t=tensor([190], device='cuda:0')
[DEBUG] cond input shape=torch.Size([1, 8]), t=tensor([190], device='cuda:0')
[DEBUG] timestep_embedding: output shape=torch.Size([1, 128])
[DEBUG] combined embedding shape=torch.Size([1, 128])
[DEBUG] after input_conv: torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] MultiScaleAttention output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] after bottleneck: torch.Size([1, 512, 64])
[DEBUG] after cross_attn: torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 1024, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 64, 512])
[DEBUG] Forward end output shape=torch.Size([1, 1, 512])
[DEBUG] Step 81/100, t=190
[DEBUG] Forward start: x=torch.Size([1, 1, 512]), cond=torch.Size([1, 8]), t=tensor([180], device='cuda:0')
[DEBUG] cond input shape=torch.Size([1, 8]), t=tensor([180], device='cuda:0')
[DEBUG] timestep_embedding: output shape=torch.Size([1, 128])
[DEBUG] combined embedding shape=torch.Size([1, 128])
[DEBUG] after input_conv: torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] MultiScaleAttention output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] after bottleneck: torch.Size([1, 512, 64])
[DEBUG] after cross_attn: torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 1024, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 64, 512])
[DEBUG] Forward end output shape=torch.Size([1, 1, 512])
[DEBUG] Forward start: x=torch.Size([1, 1, 512]), cond=torch.Size([1, 8]), t=tensor([170], device='cuda:0')
[DEBUG] cond input shape=torch.Size([1, 8]), t=tensor([170], device='cuda:0')
[DEBUG] timestep_embedding: output shape=torch.Size([1, 128])
[DEBUG] combined embedding shape=torch.Size([1, 128])
[DEBUG] after input_conv: torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] MultiScaleAttention output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] after bottleneck: torch.Size([1, 512, 64])
[DEBUG] after cross_attn: torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 1024, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 64, 512])
[DEBUG] Forward end output shape=torch.Size([1, 1, 512])
[DEBUG] Forward start: x=torch.Size([1, 1, 512]), cond=torch.Size([1, 8]), t=tensor([160], device='cuda:0')
[DEBUG] cond input shape=torch.Size([1, 8]), t=tensor([160], device='cuda:0')
[DEBUG] timestep_embedding: output shape=torch.Size([1, 128])
[DEBUG] combined embedding shape=torch.Size([1, 128])
[DEBUG] after input_conv: torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] MultiScaleAttention output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] after bottleneck: torch.Size([1, 512, 64])
[DEBUG] after cross_attn: torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 1024, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 64, 512])
[DEBUG] Forward end output shape=torch.Size([1, 1, 512])
[DEBUG] Forward start: x=torch.Size([1, 1, 512]), cond=torch.Size([1, 8]), t=tensor([150], device='cuda:0')
[DEBUG] cond input shape=torch.Size([1, 8]), t=tensor([150], device='cuda:0')
[DEBUG] timestep_embedding: output shape=torch.Size([1, 128])
[DEBUG] combined embedding shape=torch.Size([1, 128])
[DEBUG] after input_conv: torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] MultiScaleAttention output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] after bottleneck: torch.Size([1, 512, 64])
[DEBUG] after cross_attn: torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 1024, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 64, 512])
[DEBUG] Forward end output shape=torch.Size([1, 1, 512])
[DEBUG] Forward start: x=torch.Size([1, 1, 512]), cond=torch.Size([1, 8]), t=tensor([140], device='cuda:0')
[DEBUG] cond input shape=torch.Size([1, 8]), t=tensor([140], device='cuda:0')
[DEBUG] timestep_embedding: output shape=torch.Size([1, 128])
[DEBUG] combined embedding shape=torch.Size([1, 128])
[DEBUG] after input_conv: torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] MultiScaleAttention output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] after bottleneck: torch.Size([1, 512, 64])
[DEBUG] after cross_attn: torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 1024, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 64, 512])
[DEBUG] Forward end output shape=torch.Size([1, 1, 512])
[DEBUG] Forward start: x=torch.Size([1, 1, 512]), cond=torch.Size([1, 8]), t=tensor([130], device='cuda:0')
[DEBUG] cond input shape=torch.Size([1, 8]), t=tensor([130], device='cuda:0')
[DEBUG] timestep_embedding: output shape=torch.Size([1, 128])
[DEBUG] combined embedding shape=torch.Size([1, 128])
[DEBUG] after input_conv: torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] MultiScaleAttention output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] after bottleneck: torch.Size([1, 512, 64])
[DEBUG] after cross_attn: torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 1024, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 64, 512])
[DEBUG] Forward end output shape=torch.Size([1, 1, 512])
[DEBUG] Forward start: x=torch.Size([1, 1, 512]), cond=torch.Size([1, 8]), t=tensor([120], device='cuda:0')
[DEBUG] cond input shape=torch.Size([1, 8]), t=tensor([120], device='cuda:0')
[DEBUG] timestep_embedding: output shape=torch.Size([1, 128])
[DEBUG] combined embedding shape=torch.Size([1, 128])
[DEBUG] after input_conv: torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] MultiScaleAttention output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] after bottleneck: torch.Size([1, 512, 64])
[DEBUG] after cross_attn: torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 1024, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 64, 512])
[DEBUG] Forward end output shape=torch.Size([1, 1, 512])
[DEBUG] Forward start: x=torch.Size([1, 1, 512]), cond=torch.Size([1, 8]), t=tensor([110], device='cuda:0')
[DEBUG] cond input shape=torch.Size([1, 8]), t=tensor([110], device='cuda:0')
[DEBUG] timestep_embedding: output shape=torch.Size([1, 128])
[DEBUG] combined embedding shape=torch.Size([1, 128])
[DEBUG] after input_conv: torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] MultiScaleAttention output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] after bottleneck: torch.Size([1, 512, 64])
[DEBUG] after cross_attn: torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 1024, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 64, 512])
[DEBUG] Forward end output shape=torch.Size([1, 1, 512])
[DEBUG] Forward start: x=torch.Size([1, 1, 512]), cond=torch.Size([1, 8]), t=tensor([100], device='cuda:0')
[DEBUG] cond input shape=torch.Size([1, 8]), t=tensor([100], device='cuda:0')
[DEBUG] timestep_embedding: output shape=torch.Size([1, 128])
[DEBUG] combined embedding shape=torch.Size([1, 128])
[DEBUG] after input_conv: torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] MultiScaleAttention output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] after bottleneck: torch.Size([1, 512, 64])
[DEBUG] after cross_attn: torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 1024, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 64, 512])
[DEBUG] Forward end output shape=torch.Size([1, 1, 512])
[DEBUG] Forward start: x=torch.Size([1, 1, 512]), cond=torch.Size([1, 8]), t=tensor([90], device='cuda:0')
[DEBUG] cond input shape=torch.Size([1, 8]), t=tensor([90], device='cuda:0')
[DEBUG] timestep_embedding: output shape=torch.Size([1, 128])
[DEBUG] combined embedding shape=torch.Size([1, 128])
[DEBUG] after input_conv: torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] MultiScaleAttention output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] after bottleneck: torch.Size([1, 512, 64])
[DEBUG] after cross_attn: torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 1024, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 64, 512])
[DEBUG] Forward end output shape=torch.Size([1, 1, 512])
[DEBUG] Forward start: x=torch.Size([1, 1, 512]), cond=torch.Size([1, 8]), t=tensor([80], device='cuda:0')
[DEBUG] cond input shape=torch.Size([1, 8]), t=tensor([80], device='cuda:0')
[DEBUG] timestep_embedding: output shape=torch.Size([1, 128])
[DEBUG] combined embedding shape=torch.Size([1, 128])
[DEBUG] after input_conv: torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] MultiScaleAttention output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] after bottleneck: torch.Size([1, 512, 64])
[DEBUG] after cross_attn: torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 1024, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 64, 512])
[DEBUG] Forward end output shape=torch.Size([1, 1, 512])
[DEBUG] Forward start: x=torch.Size([1, 1, 512]), cond=torch.Size([1, 8]), t=tensor([70], device='cuda:0')
[DEBUG] cond input shape=torch.Size([1, 8]), t=tensor([70], device='cuda:0')
[DEBUG] timestep_embedding: output shape=torch.Size([1, 128])
[DEBUG] combined embedding shape=torch.Size([1, 128])
[DEBUG] after input_conv: torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] MultiScaleAttention output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] after bottleneck: torch.Size([1, 512, 64])
[DEBUG] after cross_attn: torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 1024, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 64, 512])
[DEBUG] Forward end output shape=torch.Size([1, 1, 512])
[DEBUG] Forward start: x=torch.Size([1, 1, 512]), cond=torch.Size([1, 8]), t=tensor([60], device='cuda:0')
[DEBUG] cond input shape=torch.Size([1, 8]), t=tensor([60], device='cuda:0')
[DEBUG] timestep_embedding: output shape=torch.Size([1, 128])
[DEBUG] combined embedding shape=torch.Size([1, 128])
[DEBUG] after input_conv: torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] MultiScaleAttention output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] after bottleneck: torch.Size([1, 512, 64])
[DEBUG] after cross_attn: torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 1024, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 64, 512])
[DEBUG] Forward end output shape=torch.Size([1, 1, 512])
[DEBUG] Forward start: x=torch.Size([1, 1, 512]), cond=torch.Size([1, 8]), t=tensor([50], device='cuda:0')
[DEBUG] cond input shape=torch.Size([1, 8]), t=tensor([50], device='cuda:0')
[DEBUG] timestep_embedding: output shape=torch.Size([1, 128])
[DEBUG] combined embedding shape=torch.Size([1, 128])
[DEBUG] after input_conv: torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] MultiScaleAttention output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] after bottleneck: torch.Size([1, 512, 64])
[DEBUG] after cross_attn: torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 1024, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 64, 512])
[DEBUG] Forward end output shape=torch.Size([1, 1, 512])
[DEBUG] Forward start: x=torch.Size([1, 1, 512]), cond=torch.Size([1, 8]), t=tensor([40], device='cuda:0')
[DEBUG] cond input shape=torch.Size([1, 8]), t=tensor([40], device='cuda:0')
[DEBUG] timestep_embedding: output shape=torch.Size([1, 128])
[DEBUG] combined embedding shape=torch.Size([1, 128])
[DEBUG] after input_conv: torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] MultiScaleAttention output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] after bottleneck: torch.Size([1, 512, 64])
[DEBUG] after cross_attn: torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 1024, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 64, 512])
[DEBUG] Forward end output shape=torch.Size([1, 1, 512])
[DEBUG] Forward start: x=torch.Size([1, 1, 512]), cond=torch.Size([1, 8]), t=tensor([30], device='cuda:0')
[DEBUG] cond input shape=torch.Size([1, 8]), t=tensor([30], device='cuda:0')
[DEBUG] timestep_embedding: output shape=torch.Size([1, 128])
[DEBUG] combined embedding shape=torch.Size([1, 128])
[DEBUG] after input_conv: torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] MultiScaleAttention output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] after bottleneck: torch.Size([1, 512, 64])
[DEBUG] after cross_attn: torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 1024, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 64, 512])
[DEBUG] Forward end output shape=torch.Size([1, 1, 512])
[DEBUG] Forward start: x=torch.Size([1, 1, 512]), cond=torch.Size([1, 8]), t=tensor([20], device='cuda:0')
[DEBUG] cond input shape=torch.Size([1, 8]), t=tensor([20], device='cuda:0')
[DEBUG] timestep_embedding: output shape=torch.Size([1, 128])
[DEBUG] combined embedding shape=torch.Size([1, 128])
[DEBUG] after input_conv: torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] MultiScaleAttention output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] after bottleneck: torch.Size([1, 512, 64])
[DEBUG] after cross_attn: torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 1024, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 64, 512])
[DEBUG] Forward end output shape=torch.Size([1, 1, 512])
[DEBUG] Forward start: x=torch.Size([1, 1, 512]), cond=torch.Size([1, 8]), t=tensor([10], device='cuda:0')
[DEBUG] cond input shape=torch.Size([1, 8]), t=tensor([10], device='cuda:0')
[DEBUG] timestep_embedding: output shape=torch.Size([1, 128])
[DEBUG] combined embedding shape=torch.Size([1, 128])
[DEBUG] after input_conv: torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] MultiScaleAttention output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] after bottleneck: torch.Size([1, 512, 64])
[DEBUG] after cross_attn: torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 1024, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 64, 512])
[DEBUG] Forward end output shape=torch.Size([1, 1, 512])
[DEBUG] Forward start: x=torch.Size([1, 1, 512]), cond=torch.Size([1, 8]), t=tensor([0], device='cuda:0')
[DEBUG] cond input shape=torch.Size([1, 8]), t=tensor([0], device='cuda:0')
[DEBUG] timestep_embedding: output shape=torch.Size([1, 128])
[DEBUG] combined embedding shape=torch.Size([1, 128])
[DEBUG] after input_conv: torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] MultiScaleAttention output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] after bottleneck: torch.Size([1, 512, 64])
[DEBUG] after cross_attn: torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 1024, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 64, 512])
[DEBUG] Forward end output shape=torch.Size([1, 1, 512])
[DEBUG] Step 100/100, t=0
[DEBUG] Forward start: x=torch.Size([1, 1, 512]), cond=torch.Size([1, 8]), t=None
[DEBUG] cond input shape=torch.Size([1, 8]), t=None
[DEBUG] timestep_embedding: output shape=torch.Size([1, 128])
[DEBUG] combined embedding shape=torch.Size([1, 128])
[DEBUG] after input_conv: torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 512])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] MultiScaleAttention output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] FiLM input: x shape=torch.Size([1, 512, 64]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 512, 64])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 512, 64])
[DEBUG] after bottleneck: torch.Size([1, 512, 64])
[DEBUG] after cross_attn: torch.Size([1, 512, 64])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 1024, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] FiLM input: x shape=torch.Size([1, 256, 128]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 256, 128])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 256, 128])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 512, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] FiLM input: x shape=torch.Size([1, 128, 256]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 128, 256])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 128, 256])
[DEBUG] EnhancedConvBlock input x shape=torch.Size([1, 256, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] FiLM input: x shape=torch.Size([1, 64, 512]), cond shape=torch.Size([1, 128])
[DEBUG] FiLM output shape=torch.Size([1, 64, 512])
[DEBUG] SquareWaveDetector output shape=torch.Size([1, 64, 512])
[DEBUG] EnhancedConvBlock output shape=torch.Size([1, 64, 512])
[DEBUG] Forward end output shape=torch.Size([1, 1, 512])
[INFO] Unique values in output: [-1.0028806  -0.9409435  -0.8811289  -0.7530781  -0.69672227 -0.6163627
 -0.6121136  -0.6069273  -0.5945086  -0.5781275  -0.5757246  -0.5712924
 -0.557105   -0.5494674  -0.53497    -0.52531254 -0.50054747 -0.49454287
 -0.49079877 -0.48618138 -0.48066294 -0.47220376 -0.46776634 -0.46449474
 -0.4624895  -0.46029502 -0.4596755  -0.458842   -0.44279468 -0.43655497
 -0.433644   -0.42830437 -0.42647403 -0.42375606 -0.42320615 -0.4227662
 -0.4209254  -0.41494238 -0.40936568 -0.40783873 -0.4041354  -0.39740443
 -0.39160284 -0.38930637 -0.37630063 -0.3716402  -0.3698744  -0.3636425
 -0.3609624  -0.36001545 -0.35905617 -0.35599402 -0.35112336 -0.3480774
 -0.34102136 -0.33931142 -0.33570975 -0.33173215 -0.32559732 -0.32540268
 -0.325092   -0.32124802 -0.32104206 -0.3160838  -0.3160504  -0.3145321
 -0.31336993 -0.3126102  -0.30868423 -0.303507   -0.29789704 -0.29668134
 -0.2944555  -0.29235682 -0.2916495  -0.28751308 -0.28592426 -0.2859127
 -0.28496712 -0.28384292 -0.27496743 -0.27216426 -0.27112776 -0.27100477
 -0.26985562 -0.2679197  -0.26536357 -0.26117504 -0.26033276 -0.25956768
 -0.25297236 -0.25246143 -0.25035584 -0.24521482 -0.24506384 -0.24433288
 -0.24365802 -0.24097878 -0.23971523 -0.23817655 -0.23609766 -0.23178259
 -0.23120926 -0.22915675 -0.2270242  -0.22338542 -0.22269894 -0.22264649
 -0.2185092  -0.21547548 -0.21422198 -0.21393329 -0.21382369 -0.21065174
 -0.20993558 -0.20976077 -0.20650321 -0.20599648 -0.20581698 -0.20475161
 -0.2015235  -0.20026357 -0.19517577 -0.19346093 -0.19307503 -0.18831041
 -0.18748023 -0.18745025 -0.18740702 -0.18691424 -0.18564695 -0.18533343
 -0.18506446 -0.18015344 -0.17700978 -0.17699909 -0.17633447 -0.17466006
 -0.17371047 -0.17280734 -0.17253011 -0.17166117 -0.1716507  -0.17048457
 -0.16950895 -0.16855505 -0.16818184 -0.16631496 -0.16616608 -0.16431639
 -0.16140713 -0.16128533 -0.16096494 -0.16075088 -0.15841502 -0.15780064
 -0.15572517 -0.15386757 -0.15210363 -0.15174371 -0.15040332 -0.1471414
 -0.14686437 -0.14442623 -0.14286812 -0.14181058 -0.14068897 -0.14010663
 -0.1397804  -0.13916472 -0.1372534  -0.13721782 -0.13512222 -0.13484082
 -0.13381723 -0.13143678 -0.13140905 -0.12854351 -0.12759177 -0.12031565
 -0.11922815 -0.11880479 -0.1171483  -0.11700411 -0.11604486 -0.11562767
 -0.11546084 -0.1154073  -0.11459962 -0.11408841 -0.11326346 -0.11302874
 -0.11267471 -0.1124268  -0.11211418 -0.11151574 -0.11092497 -0.10851911
 -0.10838833 -0.10837576 -0.10780593 -0.1071052  -0.10339442 -0.1030284
 -0.10133684 -0.09733837 -0.09337891 -0.09311769 -0.08882942 -0.08637083
 -0.08591175 -0.08498539 -0.08339907 -0.08172983 -0.08090148 -0.08044779
 -0.07972182 -0.07926732 -0.07829523 -0.0763427  -0.07522298 -0.07515408
 -0.07497552 -0.07462661 -0.07342534 -0.06906147 -0.06884104 -0.06751183
 -0.06596328 -0.06490476 -0.0630392  -0.06253502 -0.06181701 -0.06166559
 -0.06012671 -0.05755323 -0.05663348 -0.05572081 -0.0533497  -0.05239081
 -0.05119134 -0.05115564 -0.05064404 -0.04966516 -0.04822041 -0.04796361
 -0.04777513 -0.0475199  -0.04668743 -0.046067   -0.04513412 -0.04475972
 -0.04265265 -0.042362   -0.04155818 -0.04022472 -0.03853356 -0.03811652
 -0.03673442 -0.03612673 -0.03606261 -0.03461345 -0.03409519 -0.03281839
 -0.03203087 -0.03156086 -0.03053931 -0.02967994 -0.02863479 -0.02808366
 -0.02631765 -0.02603459 -0.02368285 -0.02341586 -0.02280428 -0.02176171
 -0.02119945 -0.02045211 -0.0197612  -0.01279155 -0.01180119 -0.01023252
 -0.00893593 -0.00870448 -0.00778195 -0.00420763 -0.00374455 -0.0032284
 -0.00179057  0.00198593  0.00206605  0.00490814  0.00563749  0.00713003
  0.00895415  0.01198667  0.01294257  0.01429647  0.0161224   0.01681378
  0.017382    0.01773161  0.0190616   0.02034827  0.02052125  0.02274837
  0.02287208  0.02354165  0.02357645  0.02420662  0.02470011  0.02537669
  0.02633494  0.0288192   0.02924168  0.02987787  0.03035246  0.03211169
  0.03331785  0.03566614  0.03662772  0.03843321  0.03884076  0.04068908
  0.04094712  0.04310088  0.04752705  0.04793759  0.04905577  0.05126964
  0.05427212  0.05558795  0.0570769   0.05721049  0.05816051  0.05851449
  0.05940248  0.05972539  0.0604488   0.06088403  0.06203948  0.0623915
  0.0672693   0.06842262  0.07067776  0.07354908  0.07409196  0.07428655
  0.07555151  0.07917975  0.07971203  0.08473037  0.08538389  0.08669735
  0.08799057  0.08836517  0.08869745  0.08890671  0.09021147  0.09047863
  0.09058154  0.09071188  0.0920908   0.09292047  0.09413274  0.09607255
  0.09778565  0.09802063  0.09835288  0.09948786  0.1015462   0.10341609
  0.10423923  0.10578841  0.1061849   0.10717978  0.10725155  0.10963012
  0.10995758  0.11289638  0.11369546  0.11494777  0.11583228  0.11585392
  0.12050956  0.1223394   0.12602739  0.12666696  0.12926568  0.13278092
  0.13493696  0.13659127  0.14287408  0.14355089  0.14470632  0.14561929
  0.1465953   0.15052077  0.16148016  0.16309595  0.16349694  0.16361758
  0.16489732  0.16498622  0.165001    0.16645667  0.16903013  0.17127416
  0.17272335  0.1750234   0.1770229   0.18022653  0.18210262  0.18213272
  0.18458539  0.1847612   0.18546185  0.18566743  0.18575612  0.18634525
  0.18950415  0.1909639   0.19290507  0.19412741  0.194617    0.1954396
  0.19614926  0.19696105  0.1987088   0.20138893  0.20256701  0.2033861
  0.20690137  0.20754409  0.20811027  0.20929417  0.20949519  0.21086189
  0.21216464  0.21369168  0.21400452  0.21528357  0.21661445  0.216986
  0.21768329  0.21839654  0.21910718  0.22203556  0.22248974  0.22342086
  0.2235145   0.22567728  0.23807824  0.24497965  0.25322416  0.25890633
  0.26211944  0.2652517   0.26983392  0.27292746  0.27739877  0.27746618
  0.28086     0.28173867  0.28266025  0.28601956  0.28649896  0.28850365
  0.2929387   0.29335833  0.29968256  0.30054805  0.3033769   0.30364645
  0.31465048  0.32313275  0.3237035   0.33626494  0.3414568   0.34604514
  0.34825048  0.35196635  0.3524054   0.35486096  0.3575864   0.36426142
  0.36501545  0.3761588   0.38067713  0.38567048  0.38598332  0.3887069
  0.39302093  0.39530155  0.40369514  0.40873304  0.4103516   0.41987297
  0.4213874   0.4298536   0.441707    0.45643923  0.4616674   0.46510687
  0.47378746  0.4868684   0.52070045  0.6506028   0.6615846   0.6931124
  0.7083899   0.71206546]
Figure(1200x400)